language: php

php:
  - 5.6

env:
  global:
    - PROJECT=NRGI HIPCHAT_ROOM=Build-Bot
    - secure: JVeDSbYLqIFePl0P22LF37iPVUNYHusS+VFCmzsT2uplXRNMV77iNfriB8GdBDjgWe+J3986i5U3LDzukUJXJgxnP9pNkGP2XTTobMjkD8lf2BFZ8nENWCtciQ0CWOGODhBsstT2oJ7rWBj/QKu+9PCj1HUFagFEdSbq2qVgNc8uj9JoLv8IdZRDoVtL9dDDAu67CtBDVEU3MQ3yHAtrMDd/s4jxsMRekC2SoscI3Ebjof2XQWQ1At6e21N6foqQttslo8wQkDLR8OjDIqBA6EO/RMCg6683SjOWcN3fcskVvkXsfjQpHKvpIuUIAvIlK1zHEUQClb+h16H4WPTRVQ==

before_install:
  - wget https://gist.githubusercontent.com/geshan/fe3e5a634c34bdbc9ee0/raw/b37d4dce0fc457f52dc59dd32c5535162de89979/hipchat-notifier.py

before_script:
  - mkdir -p shippable/testresults
  - mkdir -p build/logs
  - composer self-update && composer --no-interaction --prefer-dist install

script:
   - ./vendor/bin/phpunit --log-junit shippable/testresults/junit.xml

after_failure:
  - python hipchat-notifier.py --project $PROJECT --room $HIPCHAT_ROOM --token $HIPCHAT_TOKEN

after_success:
  - python hipchat-notifier.py --project $PROJECT --room $HIPCHAT_ROOM --token $HIPCHAT_TOKEN -s

notifications:
   email:
       recipients:
           - resourcecontracts@yipl.com.np
       on_success: always
       on_failure: always
